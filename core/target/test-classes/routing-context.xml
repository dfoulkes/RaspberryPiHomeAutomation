<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/integration"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:context="http://www.springframework.org/schema/context"
             xmlns:stream="http://www.springframework.org/schema/integration/stream"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
                                 http://www.springframework.org/schema/beans/spring-beans.xsd
                                 http://www.springframework.org/schema/context
                                 http://www.springframework.org/schema/context/spring-context.xsd
                                 http://www.springframework.org/schema/integration
                                 http://www.springframework.org/schema/integration/spring-integration-3.0.xsd
                                 http://www.springframework.org/schema/integration/stream
                                 http://www.springframework.org/schema/integration/stream/spring-integration-stream-3.0.xsd">

    <!-- 
           processOrder
                |
            ComponentRouter
             /     \
                   Light
          |           |
                 RestLight
                      |

    -->

    <annotation-config/>

    <!-- End points beans -->
    <beans:bean class="com.foulkes.lights.mvc.routing.endpoints.LightAdapter" id="lightRest"></beans:bean>

    <context:component-scan base-package="com.foulkes.lights.mvc.routing.*"/>

    <!-- Gateways -->
    <gateway id="homeAutomation" service-interface="com.foulkes.lights.mvc.routing.gateway.HomeAutomation"/>

    <!--Channels -->
    <channel id="processEvent"/>
    <channel id="light"/>
    <channel id="restfulCam"/>

    <!--Transformers -->
    <bridge input-channel="light" output-channel="restfulCam" />

    <!--Adapters -->
    <outbound-channel-adapter channel="restfulCam" ref="lightRest" method="processMessage" />

</beans:beans>